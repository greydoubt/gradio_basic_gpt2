import{S as x,i as ee,s as X,E as V,h as d,k as v,l as P,F as j,q as I,e as N,R as O,K as ce,a9 as mt,N as R,aa as He,ab as Xe,ai as Ge,j as pt,m as W,W as wt,I as gt,d as U,ag as dt,t as p,o as G,b as A,p as K,J as At,a6 as Se,O as vt,P as _e,v as z,w as M,x as T,a3 as Ee,aj as It,D as H,f as ue,Q,U as Y,r as yt,u as Ct,g as zt,a as Mt,B as Tt,y as Bt,z as St,A as Et,C as Rt}from"./index.63d42ec3.js";import{B as bt}from"./BlockLabel.bd54c23f.js";import{I as Re}from"./Image.2d9a6935.js";import{C as Dt,i as Ut,U as Lt,W as jt}from"./StaticImage.svelte_svelte_type_style_lang.99b34cbf.js";import{I as De,C as Nt,M as Ue}from"./ModifyUpload.fd5cd596.js";import{U as Ft}from"./Upload.e044a31e.js";import{E as qt}from"./Empty.33058914.js";import{U as Ot}from"./UploadText.c11d9908.js";import{E as Vn}from"./Image.f0ce1ac8.js";/* empty css                                                   */function Wt(t){let e,n,i;return{c(){e=V("svg"),n=V("path"),i=V("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(i,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(i,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(r,s){v(r,e,s),P(e,n),P(e,i)},p:j,i:j,o:j,d(r){r&&I(e)}}}class Pt extends x{constructor(e){super(),ee(this,e,null,Wt,X,{})}}function Jt(t){let e,n,i,r,s,l,o;return{c(){e=V("svg"),n=V("circle"),i=V("circle"),r=V("circle"),s=V("circle"),l=V("circle"),o=V("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(i,"cx","16"),d(i,"cy","9"),d(i,"r","2"),d(i,"fill","currentColor"),d(r,"cx","22"),d(r,"cy","12"),d(r,"r","2"),d(r,"fill","currentColor"),d(s,"cx","23"),d(s,"cy","18"),d(s,"r","2"),d(s,"fill","currentColor"),d(l,"cx","19"),d(l,"cy","23"),d(l,"r","2"),d(l,"fill","currentColor"),d(o,"fill","currentColor"),d(o,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(u,h){v(u,e,h),P(e,n),P(e,i),P(e,r),P(e,s),P(e,l),P(e,o)},p:j,i:j,o:j,d(u){u&&I(e)}}}class Ht extends x{constructor(e){super(),ee(this,e,null,Jt,X,{})}}function Qt(t){let e,n;return{c(){e=V("svg"),n=V("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(i,r){v(i,e,r),P(e,n)},p:j,i:j,o:j,d(i){i&&I(e)}}}class Ke extends x{constructor(e){super(),ee(this,e,null,Qt,X,{})}}function Yt(t){let e,n;return{c(){e=N("img"),O(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(i,r){v(i,e,r),t[2](e)},p(i,[r]){r&1&&!O(e.src,n=i[0])&&d(e,"src",n)},i:j,o:j,d(i){i&&I(e),t[2](null)}}}function Vt(t,e,n){let{image:i}=e,r;const s=ce();mt(()=>{const o=new Dt(r,{autoCropArea:1,cropend(){const u=o.getCroppedCanvas().toDataURL();s("crop",u)}});return s("crop",i),()=>{o.destroy()}});function l(o){R[o?"unshift":"push"](()=>{r=o,n(1,r)})}return t.$$set=o=>{"image"in o&&n(0,i=o.image)},[i,r,l]}class kt extends x{constructor(e){super(),ee(this,e,Vt,Yt,X,{image:0})}}class Ze{constructor(e,n){this.x=e,this.y=n}}class $e extends Ze{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const i=e+Math.PI/2;this.x=this.x+Math.sin(i)*n,this.y=this.y-Math.cos(i)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new Ze(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const Xt=30;class Gt{constructor({radius:e=Xt,enabled:n=!0,initialPoint:i={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new $e(i.x,i.y),this.brush=new $e(i.x,i.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function xe(t,e,n){const i=t.slice();return i[56]=e[n].name,i[57]=e[n].zIndex,i[58]=e,i[59]=n,i}function et(t){let e,n,i;return{c(){e=N("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-13f9i4m")},m(r,s){v(r,e,s),i=!0},i(r){i||(He(()=>{n||(n=Xe(e,Ge,{duration:50},!0)),n.run(1)}),i=!0)},o(r){n||(n=Xe(e,Ge,{duration:50},!1)),n.run(0),i=!1},d(r){r&&I(e),r&&n&&n.end()}}}function tt(t){let e,n,i=t[56],r,s;const l=()=>t[27](e,i),o=()=>t[27](null,i);return{c(){e=N("canvas"),d(e,"key",n=t[56]),pt(e,"z-index",t[57]),d(e,"class","svelte-13f9i4m")},m(u,h){v(u,e,h),l(),r||(s=[W(e,"mousedown",t[56]==="interface"?t[6]:void 0),W(e,"mousemove",t[56]==="interface"?t[7]:void 0),W(e,"mouseup",t[56]==="interface"?t[8]:void 0),W(e,"mouseout",t[56]==="interface"?t[8]:void 0),W(e,"blur",t[56]==="interface"?t[8]:void 0),W(e,"touchstart",t[56]==="interface"?t[6]:void 0),W(e,"touchmove",t[56]==="interface"?t[7]:void 0),W(e,"touchend",t[56]==="interface"?t[8]:void 0),W(e,"touchcancel",t[56]==="interface"?t[8]:void 0),W(e,"click",wt(t[26]))],r=!0)},p(u,h){t=u,i!==t[56]&&(o(),i=t[56],l())},d(u){u&&I(e),o(),r=!1,gt(s)}}}function Kt(t){let e,n,i,r,s=t[4]===0&&et(),l=t[5],o=[];for(let u=0;u<l.length;u+=1)o[u]=tt(xe(t,l,u));return{c(){e=N("div"),s&&s.c(),n=U();for(let u=0;u<o.length;u+=1)o[u].c();d(e,"class","wrap svelte-13f9i4m"),He(()=>t[29].call(e))},m(u,h){v(u,e,h),s&&s.m(e,null),P(e,n);for(let _=0;_<o.length;_+=1)o[_].m(e,null);t[28](e),i=dt(e,t[29].bind(e)),r=!0},p(u,h){if(u[4]===0?s?h[0]&16&&p(s,1):(s=et(),s.c(),p(s,1),s.m(e,n)):s&&(G(),A(s,1,1,()=>{s=null}),K()),h[0]&481){l=u[5];let _;for(_=0;_<l.length;_+=1){const g=xe(u,l,_);o[_]?o[_].p(g,h):(o[_]=tt(g),o[_].c(),o[_].m(e,null))}for(;_<o.length;_+=1)o[_].d(1);o.length=l.length}},i(u){r||(p(s),r=!0)},o(u){A(s),r=!1},d(u){u&&I(e),s&&s.d(),At(o,u),t[28](null),i()}}}let Zt="#aaa";function nt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function $t(t,e,n){let i;const r=ce();let{value:s}=e,{value_img:l}=e,{mode:o="sketch"}=e,{brush_color:u="#0b0f19"}=e,{brush_radius:h=50}=e,{source:_}=e,{width:g=400}=e,{height:a=200}=e,{container_height:f=200}=e,b,y=g,E=a,te;const ne=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let B={},k={},J=[],q=[],ie=!0,re=!0,D=!1,w=!1,L=null,le=null,oe=null,$=0;mt(async()=>{Object.keys(B).forEach(m=>{n(23,k[m]=B[m].getContext("2d"),k)}),await Se(),l&&(l.addEventListener("load",m=>{_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(l,0,0),k.temp.restore()):k.temp.drawImage(l,0,0),k.drawing.drawImage(B.temp,0,0,g,a),se()}),setTimeout(()=>{_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(l,0,0),k.temp.restore()):k.temp.drawImage(l,0,0),k.drawing.drawImage(B.temp,0,0,g,a),he({lines:q.slice()}),se()},100)),n(25,L=new Gt({radius:h*.05,enabled:!0,initialPoint:{x:g/2,y:a/2}})),oe=new Ut((m,c,...C)=>{Ae(m,c)}),oe.observe(le),me(),n(21,b=!0),requestAnimationFrame(()=>{de(),requestAnimationFrame(()=>{fe()})})});function de(){const m=g/2,c=a/2;L.update({x:m,y:c},{both:!0}),L.update({x:m,y:c},{both:!1}),ie=!0,re=!0}vt(()=>{n(21,b=!1),oe.unobserve(le)});function Le(){const m=q.slice(0,-1);Te(),l&&(_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(l,0,0),k.temp.restore()):k.temp.drawImage(l,0,0),(!q||!q.length)&&k.drawing.drawImage(B.temp,0,0,g,a)),he({lines:m}),n(4,$=m.length),q.length&&n(24,q=m),q.length==0&&r("clear"),se()}let he=({lines:m})=>{m.forEach(c=>{const{points:C,brush_color:S,brush_radius:F}=c;ye({points:C,brush_color:S,brush_radius:F}),o==="mask"&&Ce({points:C,brush_color:S,brush_radius:F}),J=C}),Me({brush_color:u,brush_radius:h}),o==="mask"&&ze()},je=m=>{m.preventDefault(),w=!0;const{x:c,y:C}=ve(m);m.touches&&m.touches.length>0&&L.update({x:c,y:C},{both:!0}),Ie(c,C),n(4,$+=1)},be=m=>{m.preventDefault();const{x:c,y:C}=ve(m);Ie(c,C)},Ne=m=>{m.preventDefault(),be(m),D=!1,w=!1,Me(),o==="mask"&&ze()},ke=0,pe=0,we=0,Ae=async()=>{if(g===ke&&a===pe&&we===f)return;const m={width:g,height:a},c={height:f,width:f*(m.width/m.height)};await Promise.all([ae(B.interface,m,c),ae(B.drawing,m,c),ae(B.temp,m,c),ae(B.temp_fake,m,c),ae(B.mask,m,c,!1)]),n(9,h=20*(m.width/c.width)),me({once:!0}),setTimeout(()=>{pe=a,ke=g,we=f},100),fe()},ae=async(m,c,C,S=!0)=>{if(!b)return;await Se();const F=window.devicePixelRatio||1;m.width=c.width*(S?F:1),m.height=c.height*(S?F:1);const Z=m.getContext("2d");S&&Z.scale(F,F),m.style.width=`${C.width}px`,m.style.height=`${C.height}px`},ve=m=>{const c=B.interface.getBoundingClientRect();let C=m.clientX,S=m.clientY;return m.changedTouches&&m.changedTouches.length>0&&(C=m.changedTouches[0].clientX,S=m.changedTouches[0].clientY),{x:(C-c.left)/c.width*g,y:(S-c.top)/c.height*a}},Ie=(m,c)=>{L.update({x:m,y:c});const C=!L.isEnabled();(w&&!D||C&&w)&&(D=!0,J.push(L.brush.toObject())),D&&(J.push(L.brush.toObject()),ye({points:J,brush_color:u,brush_radius:h}),o==="mask"&&Ce({points:J,brush_color:u,brush_radius:h})),ie=!0},ye=({points:m,brush_color:c,brush_radius:C})=>{if(!m||m.length<2||(n(23,k.temp.lineJoin="round",k),n(23,k.temp.lineCap="round",k),n(23,k.temp.strokeStyle=c,k),n(23,k.temp.lineWidth=C,k),!m||m.length<2))return;let S=m[0],F=m[1];k.temp.moveTo(F.x,F.y),k.temp.beginPath();for(var Z=1,Je=m.length;Z<Je;Z++){var ge=nt(S,F);k.temp.quadraticCurveTo(S.x,S.y,ge.x,ge.y),S=m[Z],F=m[Z+1]}k.temp.lineTo(S.x,S.y),k.temp.stroke()},Ce=({points:m,brush_color:c,brush_radius:C})=>{if(!m||m.length<2)return;n(23,k.temp_fake.lineJoin="round",k),n(23,k.temp_fake.lineCap="round",k),n(23,k.temp_fake.strokeStyle="#fff",k),n(23,k.temp_fake.lineWidth=C,k);let S=m[0],F=m[1];k.temp_fake.moveTo(F.x,F.y),k.temp_fake.beginPath();for(var Z=1,Je=m.length;Z<Je;Z++){var ge=nt(S,F);k.temp_fake.quadraticCurveTo(S.x,S.y,ge.x,ge.y),S=m[Z],F=m[Z+1]}k.temp_fake.lineTo(S.x,S.y),k.temp_fake.stroke()},ze=()=>{J.length<1||(J.length=0,k.mask.drawImage(B.temp_fake,0,0,g,a),se())},Me=()=>{J.length<1||(q.push({points:J.slice(),brush_color:u,brush_radius:h}),o!=="mask"&&(J.length=0),k.drawing.drawImage(B.temp,0,0,g,a),se())},se=()=>{const m=Be();r("change",m)};function fe(){return n(24,q=[]),Te(),n(4,$=0),!0}function Te(){re=!0,k.temp.clearRect(0,0,g,a),n(23,k.temp.fillStyle=o==="mask"?"transparent":"#FFFFFF",k),k.temp.fillRect(0,0,g,a),o==="mask"&&(k.temp_fake.clearRect(0,0,B.temp_fake.width,B.temp_fake.height),k.mask.clearRect(0,0,g,a),n(23,k.mask.fillStyle="#000",k),k.mask.fillRect(0,0,g,a))}let me=({once:m=!1}={})=>{if(ie||re){const c=L.getPointerCoordinates(),C=L.getBrushCoordinates();Fe(k.interface,c,C),ie=!1,re=!1}m||window.requestAnimationFrame(()=>{me()})},Fe=(m,c,C)=>{m.clearRect(0,0,g,a),m.beginPath(),m.fillStyle=u,m.arc(C.x,C.y,h/2,0,Math.PI*2,!0),m.fill(),m.beginPath(),m.fillStyle=Zt,m.arc(C.x,C.y,i,0,Math.PI*2,!0),m.fill()};function Be(){return o==="mask"?B.mask.toDataURL("image/jpg"):B.drawing.toDataURL("image/jpg")}function qe(m){_e.call(this,t,m)}function Oe(m,c){R[m?"unshift":"push"](()=>{B[c]=m,n(0,B)})}function We(m){R[m?"unshift":"push"](()=>{le=m,n(3,le)})}function Pe(){y=this.offsetWidth,E=this.offsetHeight,n(1,y),n(2,E)}return t.$$set=m=>{"value"in m&&n(10,s=m.value),"value_img"in m&&n(11,l=m.value_img),"mode"in m&&n(12,o=m.mode),"brush_color"in m&&n(13,u=m.brush_color),"brush_radius"in m&&n(9,h=m.brush_radius),"source"in m&&n(14,_=m.source),"width"in m&&n(15,g=m.width),"height"in m&&n(16,a=m.height),"container_height"in m&&n(17,f=m.container_height)},t.$$.update=()=>{t.$$.dirty[0]&2098176&&b&&!s&&fe(),t.$$.dirty[0]&31574017&&b&&l!==te&&(n(22,te=l),fe(),setTimeout(()=>{_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(l,0,0),k.temp.restore()):k.temp.drawImage(l,0,0),k.drawing.drawImage(B.temp,0,0,g,a),he({lines:q.slice()}),se()},50)),t.$$.dirty[0]&33554944&&L&&(de(),L.setRadius(h*.05)),t.$$.dirty[0]&98304&&(g||a)&&Ae(),t.$$.dirty[0]&512&&(i=h*.075)},[B,y,E,le,$,ne,je,be,Ne,h,s,l,o,u,_,g,a,f,Le,fe,Be,b,te,k,q,L,qe,Oe,We,Pe]}class Qe extends x{constructor(e){super(),ee(this,e,$t,Kt,X,{value:10,value_img:11,mode:12,brush_color:13,brush_radius:9,source:14,width:15,height:16,container_height:17,undo:18,clear:19,get_image_data:20},null,[-1,-1])}get undo(){return this.$$.ctx[18]}get clear(){return this.$$.ctx[19]}get get_image_data(){return this.$$.ctx[20]}}function xt(t){let e,n,i,r,s;return n=new De({props:{Icon:Lt,label:"Undo"}}),n.$on("click",t[1]),r=new De({props:{Icon:Nt,label:"Clear"}}),r.$on("click",t[2]),{c(){e=N("div"),z(n.$$.fragment),i=U(),z(r.$$.fragment),d(e,"class","svelte-16330ex")},m(l,o){v(l,e,o),M(n,e,null),P(e,i),M(r,e,null),s=!0},p:j,i(l){s||(p(n.$$.fragment,l),p(r.$$.fragment,l),s=!0)},o(l){A(n.$$.fragment,l),A(r.$$.fragment,l),s=!1},d(l){l&&I(e),T(n),T(r)}}}function en(t){const e=ce();return[e,()=>e("undo"),r=>{e("clear"),r.stopPropagation()}]}class Ye extends x{constructor(e){super(),ee(this,e,en,xt,X,{})}}function it(t){let e,n,i,r,s;return{c(){e=N("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",i=75*(t[2]/t[6])),d(e,"class","svelte-11lfbcw")},m(l,o){v(l,e,o),Ee(e,t[0]),r||(s=[W(e,"change",t[10]),W(e,"input",t[10])],r=!0)},p(l,o){o&68&&n!==(n=.5*(l[2]/l[6]))&&d(e,"min",n),o&68&&i!==(i=75*(l[2]/l[6]))&&d(e,"max",i),o&1&&Ee(e,l[0])},d(l){l&&I(e),r=!1,gt(s)}}}function rt(t){let e,n,i,r;n=new De({props:{Icon:Ht,label:"Select brush color"}}),n.$on("click",t[11]);let s=t[5]&&lt(t);return{c(){e=N("span"),z(n.$$.fragment),i=U(),s&&s.c(),d(e,"class","col svelte-11lfbcw")},m(l,o){v(l,e,o),M(n,e,null),P(e,i),s&&s.m(e,null),r=!0},p(l,o){l[5]?s?s.p(l,o):(s=lt(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i(l){r||(p(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&I(e),T(n),s&&s.d()}}}function lt(t){let e,n,i;return{c(){e=N("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-11lfbcw")},m(r,s){v(r,e,s),Ee(e,t[1]),n||(i=W(e,"input",t[12]),n=!0)},p(r,s){s&2&&Ee(e,r[1])},d(r){r&&I(e),n=!1,i()}}}function tn(t){let e,n,i,r,s,l;i=new De({props:{Icon:Pt,label:"Use brush"}}),i.$on("click",t[9]);let o=t[4]&&it(t),u=t[3]!=="mask"&&rt(t);return{c(){e=N("div"),n=N("span"),z(i.$$.fragment),r=U(),o&&o.c(),s=U(),u&&u.c(),d(n,"class","brush svelte-11lfbcw"),d(e,"class","wrap svelte-11lfbcw")},m(h,_){v(h,e,_),P(e,n),M(i,n,null),P(n,r),o&&o.m(n,null),P(e,s),u&&u.m(e,null),l=!0},p(h,[_]){h[4]?o?o.p(h,_):(o=it(h),o.c(),o.m(n,null)):o&&(o.d(1),o=null),h[3]!=="mask"?u?(u.p(h,_),_&8&&p(u,1)):(u=rt(h),u.c(),p(u,1),u.m(e,null)):u&&(G(),A(u,1,1,()=>{u=null}),K())},i(h){l||(p(i.$$.fragment,h),p(u),l=!0)},o(h){A(i.$$.fragment,h),A(u),l=!1},d(h){h&&I(e),T(i),o&&o.d(),u&&u.d()}}}function nn(t,e,n){let i;ce();let r=!1,s=!1,{brush_radius:l=20}=e,{brush_color:o="#000"}=e,{container_height:u}=e,{img_width:h}=e,{img_height:_}=e,{mode:g="other"}=e;const a=()=>n(4,r=!r);function f(){l=It(this.value),n(0,l)}const b=()=>n(5,s=!s);function y(){o=this.value,n(1,o)}return t.$$set=E=>{"brush_radius"in E&&n(0,l=E.brush_radius),"brush_color"in E&&n(1,o=E.brush_color),"container_height"in E&&n(7,u=E.container_height),"img_width"in E&&n(2,h=E.img_width),"img_height"in E&&n(8,_=E.img_height),"mode"in E&&n(3,g=E.mode)},t.$$.update=()=>{t.$$.dirty&388&&n(6,i=u*(h/_))},[l,o,h,g,r,s,i,u,_,a,f,b,y]}class Ve extends x{constructor(e){super(),ee(this,e,nn,tn,X,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function rn(t){let e,n;return{c(){e=N("img"),O(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-zyic3i"),H(e,"webcam",t[4]==="webcam"&&t[7])},m(i,r){v(i,e,r)},p(i,r){r[0]&1&&!O(e.src,n=i[0].image||i[0])&&d(e,"src",n),r[0]&144&&H(e,"webcam",i[4]==="webcam"&&i[7])},i:j,o:j,d(i){i&&I(e)}}}function ln(t){let e=t[18],n,i,r,s=st(t),l=t[12]>0&&ut(t);return{c(){s.c(),n=U(),l&&l.c(),i=ue()},m(o,u){s.m(o,u),v(o,n,u),l&&l.m(o,u),v(o,i,u),r=!0},p(o,u){u[0]&262144&&X(e,e=o[18])?(s.d(1),s=st(o),s.c(),s.m(n.parentNode,n)):s.p(o,u),o[12]>0?l?(l.p(o,u),u[0]&4096&&p(l,1)):(l=ut(o),l.c(),p(l,1),l.m(i.parentNode,i)):l&&(G(),A(l,1,1,()=>{l=null}),K())},i(o){r||(p(l),r=!0)},o(o){A(l),r=!1},d(o){s.d(o),o&&I(n),l&&l.d(o),o&&I(i)}}}function sn(t){let e,n,i,r,s;return e=new Ue({props:{editable:!0}}),e.$on("edit",t[45]),e.$on("clear",t[21]),{c(){z(e.$$.fragment),n=U(),i=N("img"),O(i.src,r=t[0])||d(i,"src",r),d(i,"alt",""),d(i,"class","svelte-zyic3i"),H(i,"webcam",t[4]==="webcam"&&t[7])},m(l,o){M(e,l,o),v(l,n,o),v(l,i,o),s=!0},p(l,o){(!s||o[0]&1&&!O(i.src,r=l[0]))&&d(i,"src",r),o[0]&144&&H(i,"webcam",l[4]==="webcam"&&l[7])},i(l){s||(p(e.$$.fragment,l),s=!0)},o(l){A(e.$$.fragment,l),s=!1},d(l){T(e,l),l&&I(n),l&&I(i)}}}function un(t){let e,n,i,r;return e=new kt({props:{image:t[0]}}),e.$on("crop",t[22]),i=new Ue({}),i.$on("clear",t[44]),{c(){z(e.$$.fragment),n=U(),z(i.$$.fragment)},m(s,l){M(e,s,l),v(s,n,l),M(i,s,l),r=!0},p(s,l){const o={};l[0]&1&&(o.image=s[0]),e.$set(o)},i(s){r||(p(e.$$.fragment,s),p(i.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),A(i.$$.fragment,s),r=!1},d(s){T(e,s),s&&I(n),T(i,s)}}}function on(t){let e,n,i=t[4]==="webcam"&&!t[18]&&at(t);return{c(){i&&i.c(),e=ue()},m(r,s){i&&i.m(r,s),v(r,e,s),n=!0},p(r,s){r[4]==="webcam"&&!r[18]?i?(i.p(r,s),s[0]&262160&&p(i,1)):(i=at(r),i.c(),p(i,1),i.m(e.parentNode,e)):i&&(G(),A(i,1,1,()=>{i=null}),K())},i(r){n||(p(i),n=!0)},o(r){A(i),n=!1},d(r){i&&i.d(r),r&&I(e)}}}function an(t){let e,n,i,r,s,l,o;e=new Ye({}),e.$on("undo",t[36]),e.$on("clear",t[24]);let u=t[1]==="color-sketch"&&ft(t);function h(a){t[39](a)}function _(a){t[40](a)}let g={value:t[0],mode:t[9],width:t[12]||t[17],height:t[11]||t[16],container_height:t[13]||t[16]};return t[14]!==void 0&&(g.brush_radius=t[14]),t[19]!==void 0&&(g.brush_color=t[19]),r=new Qe({props:g}),R.push(()=>Y(r,"brush_radius",h)),R.push(()=>Y(r,"brush_color",_)),t[41](r),r.$on("change",t[22]),r.$on("clear",t[24]),{c(){z(e.$$.fragment),n=U(),u&&u.c(),i=U(),z(r.$$.fragment)},m(a,f){M(e,a,f),v(a,n,f),u&&u.m(a,f),v(a,i,f),M(r,a,f),o=!0},p(a,f){a[1]==="color-sketch"?u?(u.p(a,f),f[0]&2&&p(u,1)):(u=ft(a),u.c(),p(u,1),u.m(i.parentNode,i)):u&&(G(),A(u,1,1,()=>{u=null}),K());const b={};f[0]&1&&(b.value=a[0]),f[0]&512&&(b.mode=a[9]),f[0]&135168&&(b.width=a[12]||a[17]),f[0]&67584&&(b.height=a[11]||a[16]),f[0]&73728&&(b.container_height=a[13]||a[16]),!s&&f[0]&16384&&(s=!0,b.brush_radius=a[14],Q(()=>s=!1)),!l&&f[0]&524288&&(l=!0,b.brush_color=a[19],Q(()=>l=!1)),r.$set(b)},i(a){o||(p(e.$$.fragment,a),p(u),p(r.$$.fragment,a),o=!0)},o(a){A(e.$$.fragment,a),A(u),A(r.$$.fragment,a),o=!1},d(a){T(e,a),a&&I(n),u&&u.d(a),a&&I(i),t[41](null),T(r,a)}}}function fn(t){let e,n,i;function r(l){t[35](l)}let s={filetype:"image/png,image/gif,image/jpeg",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[dn]},$$scope:{ctx:t}};return t[8]!==void 0&&(s.dragging=t[8]),e=new Ft({props:s}),R.push(()=>Y(e,"dragging",r)),e.$on("load",t[20]),{c(){z(e.$$.fragment)},m(l,o){M(e,l,o),i=!0},p(l,o){const u={};o[0]&1&&(u.disable_click=!!l[0]),o[0]&1048243|o[1]&8388608&&(u.$$scope={dirty:o,ctx:l}),!n&&o[0]&256&&(n=!0,u.dragging=l[8],Q(()=>n=!1)),e.$set(u)},i(l){i||(p(e.$$.fragment,l),i=!0)},o(l){A(e.$$.fragment,l),i=!1},d(l){T(e,l)}}}function st(t){let e,n,i,r;return{c(){e=N("img"),d(e,"class","absolute-img svelte-zyic3i"),O(e.src,n=t[18]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),H(e,"webcam",t[4]==="webcam"&&t[7])},m(s,l){v(s,e,l),t[46](e),i||(r=W(e,"load",t[23]),i=!0)},p(s,l){l[0]&262145&&!O(e.src,n=s[18]||s[0]?.image||s[0])&&d(e,"src",n),l[0]&144&&H(e,"webcam",s[4]==="webcam"&&s[7])},d(s){s&&I(e),t[46](null),i=!1,r()}}}function ut(t){let e,n,i,r,s,l,o,u;function h(f){t[48](f)}function _(f){t[49](f)}let g={value:t[0],mode:t[9],width:t[12]||t[17],height:t[11]||t[16],container_height:t[13]||t[16],value_img:t[15],source:t[4]};t[14]!==void 0&&(g.brush_radius=t[14]),t[19]!==void 0&&(g.brush_color=t[19]),e=new Qe({props:g}),t[47](e),R.push(()=>Y(e,"brush_radius",h)),R.push(()=>Y(e,"brush_color",_)),e.$on("change",t[22]),s=new Ye({}),s.$on("undo",t[50]),s.$on("clear",t[24]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&ot(t);return{c(){z(e.$$.fragment),r=U(),z(s.$$.fragment),l=U(),a&&a.c(),o=ue()},m(f,b){M(e,f,b),v(f,r,b),M(s,f,b),v(f,l,b),a&&a.m(f,b),v(f,o,b),u=!0},p(f,b){const y={};b[0]&1&&(y.value=f[0]),b[0]&512&&(y.mode=f[9]),b[0]&135168&&(y.width=f[12]||f[17]),b[0]&67584&&(y.height=f[11]||f[16]),b[0]&73728&&(y.container_height=f[13]||f[16]),b[0]&32768&&(y.value_img=f[15]),b[0]&16&&(y.source=f[4]),!n&&b[0]&16384&&(n=!0,y.brush_radius=f[14],Q(()=>n=!1)),!i&&b[0]&524288&&(i=!0,y.brush_color=f[19],Q(()=>i=!1)),e.$set(y),f[1]==="color-sketch"||f[1]==="sketch"?a?(a.p(f,b),b[0]&2&&p(a,1)):(a=ot(f),a.c(),p(a,1),a.m(o.parentNode,o)):a&&(G(),A(a,1,1,()=>{a=null}),K())},i(f){u||(p(e.$$.fragment,f),p(s.$$.fragment,f),p(a),u=!0)},o(f){A(e.$$.fragment,f),A(s.$$.fragment,f),A(a),u=!1},d(f){t[47](null),T(e,f),f&&I(r),T(s,f),f&&I(l),a&&a.d(f),f&&I(o)}}}function ot(t){let e,n,i,r;function s(u){t[51](u)}function l(u){t[52](u)}let o={container_height:t[13]||t[16],img_width:t[12]||t[17],img_height:t[11]||t[16],mode:t[9]};return t[14]!==void 0&&(o.brush_radius=t[14]),t[19]!==void 0&&(o.brush_color=t[19]),e=new Ve({props:o}),R.push(()=>Y(e,"brush_radius",s)),R.push(()=>Y(e,"brush_color",l)),{c(){z(e.$$.fragment)},m(u,h){M(e,u,h),r=!0},p(u,h){const _={};h[0]&73728&&(_.container_height=u[13]||u[16]),h[0]&135168&&(_.img_width=u[12]||u[17]),h[0]&67584&&(_.img_height=u[11]||u[16]),h[0]&512&&(_.mode=u[9]),!n&&h[0]&16384&&(n=!0,_.brush_radius=u[14],Q(()=>n=!1)),!i&&h[0]&524288&&(i=!0,_.brush_color=u[19],Q(()=>i=!1)),e.$set(_)},i(u){r||(p(e.$$.fragment,u),r=!0)},o(u){A(e.$$.fragment,u),r=!1},d(u){T(e,u)}}}function at(t){let e,n;return e=new jt({props:{streaming:t[5],pending:t[6],mirror_webcam:t[7]}}),e.$on("capture",t[42]),e.$on("stream",t[22]),e.$on("error",t[43]),{c(){z(e.$$.fragment)},m(i,r){M(e,i,r),n=!0},p(i,r){const s={};r[0]&32&&(s.streaming=i[5]),r[0]&64&&(s.pending=i[6]),r[0]&128&&(s.mirror_webcam=i[7]),e.$set(s)},i(i){n||(p(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function ft(t){let e,n,i,r;function s(u){t[37](u)}function l(u){t[38](u)}let o={container_height:t[13]||t[16],img_width:t[12]||t[17],img_height:t[11]||t[16]};return t[14]!==void 0&&(o.brush_radius=t[14]),t[19]!==void 0&&(o.brush_color=t[19]),e=new Ve({props:o}),R.push(()=>Y(e,"brush_radius",s)),R.push(()=>Y(e,"brush_color",l)),{c(){z(e.$$.fragment)},m(u,h){M(e,u,h),r=!0},p(u,h){const _={};h[0]&73728&&(_.container_height=u[13]||u[16]),h[0]&135168&&(_.img_width=u[12]||u[17]),h[0]&67584&&(_.img_height=u[11]||u[16]),!n&&h[0]&16384&&(n=!0,_.brush_radius=u[14],Q(()=>n=!1)),!i&&h[0]&524288&&(i=!0,_.brush_color=u[19],Q(()=>i=!1)),e.$set(_)},i(u){r||(p(e.$$.fragment,u),r=!0)},o(u){A(e.$$.fragment,u),r=!1},d(u){T(e,u)}}}function _n(t){let e,n;return{c(){e=N("img"),O(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-zyic3i"),H(e,"webcam",t[4]==="webcam"&&t[7])},m(i,r){v(i,e,r)},p(i,r){r[0]&1&&!O(e.src,n=i[0].image||i[0])&&d(e,"src",n),r[0]&144&&H(e,"webcam",i[4]==="webcam"&&i[7])},i:j,o:j,d(i){i&&I(e)}}}function cn(t){let e=t[18],n,i,r,s=_t(t),l=t[12]>0&&ct(t);return{c(){s.c(),n=U(),l&&l.c(),i=ue()},m(o,u){s.m(o,u),v(o,n,u),l&&l.m(o,u),v(o,i,u),r=!0},p(o,u){u[0]&262144&&X(e,e=o[18])?(s.d(1),s=_t(o),s.c(),s.m(n.parentNode,n)):s.p(o,u),o[12]>0?l?(l.p(o,u),u[0]&4096&&p(l,1)):(l=ct(o),l.c(),p(l,1),l.m(i.parentNode,i)):l&&(G(),A(l,1,1,()=>{l=null}),K())},i(o){r||(p(l),r=!0)},o(o){A(l),r=!1},d(o){s.d(o),o&&I(n),l&&l.d(o),o&&I(i)}}}function hn(t){let e,n,i,r,s;return e=new Ue({props:{editable:!0}}),e.$on("edit",t[27]),e.$on("clear",t[21]),{c(){z(e.$$.fragment),n=U(),i=N("img"),O(i.src,r=t[0])||d(i,"src",r),d(i,"alt",""),d(i,"class","svelte-zyic3i"),H(i,"scale-x-[-1]",t[4]==="webcam"&&t[7])},m(l,o){M(e,l,o),v(l,n,o),v(l,i,o),s=!0},p(l,o){(!s||o[0]&1&&!O(i.src,r=l[0]))&&d(i,"src",r),o[0]&144&&H(i,"scale-x-[-1]",l[4]==="webcam"&&l[7])},i(l){s||(p(e.$$.fragment,l),s=!0)},o(l){A(e.$$.fragment,l),s=!1},d(l){T(e,l),l&&I(n),l&&I(i)}}}function mn(t){let e,n,i,r;return e=new kt({props:{image:t[0]}}),e.$on("crop",t[22]),i=new Ue({}),i.$on("clear",t[26]),{c(){z(e.$$.fragment),n=U(),z(i.$$.fragment)},m(s,l){M(e,s,l),v(s,n,l),M(i,s,l),r=!0},p(s,l){const o={};l[0]&1&&(o.image=s[0]),e.$set(o)},i(s){r||(p(e.$$.fragment,s),p(i.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),A(i.$$.fragment,s),r=!1},d(s){T(e,s),s&&I(n),T(i,s)}}}function gn(t){let e;const n=t[25].default,i=yt(n,t,t[54],null);return{c(){i&&i.c()},m(r,s){i&&i.m(r,s),e=!0},p(r,s){i&&i.p&&(!e||s[1]&8388608)&&Ct(i,n,r,r[54],e?Mt(n,r[54],s,null):zt(r[54]),null)},i(r){e||(p(i,r),e=!0)},o(r){A(i,r),e=!1},d(r){i&&i.d(r)}}}function _t(t){let e,n,i,r;return{c(){e=N("img"),d(e,"class","absolute-img svelte-zyic3i"),O(e.src,n=t[18]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),H(e,"webcam",t[4]==="webcam"&&t[7])},m(s,l){v(s,e,l),t[28](e),i||(r=W(e,"load",t[23]),i=!0)},p(s,l){l[0]&262145&&!O(e.src,n=s[18]||s[0]?.image||s[0])&&d(e,"src",n),l[0]&144&&H(e,"webcam",s[4]==="webcam"&&s[7])},d(s){s&&I(e),t[28](null),i=!1,r()}}}function ct(t){let e,n,i,r,s,l,o,u;function h(f){t[30](f)}function _(f){t[31](f)}let g={value:t[0],mode:t[9],width:t[12]||t[17],height:t[11]||t[16],container_height:t[13]||t[16],value_img:t[15],source:t[4]};t[14]!==void 0&&(g.brush_radius=t[14]),t[19]!==void 0&&(g.brush_color=t[19]),e=new Qe({props:g}),t[29](e),R.push(()=>Y(e,"brush_radius",h)),R.push(()=>Y(e,"brush_color",_)),e.$on("change",t[22]),s=new Ye({}),s.$on("undo",t[32]),s.$on("clear",t[24]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&ht(t);return{c(){z(e.$$.fragment),r=U(),z(s.$$.fragment),l=U(),a&&a.c(),o=ue()},m(f,b){M(e,f,b),v(f,r,b),M(s,f,b),v(f,l,b),a&&a.m(f,b),v(f,o,b),u=!0},p(f,b){const y={};b[0]&1&&(y.value=f[0]),b[0]&512&&(y.mode=f[9]),b[0]&135168&&(y.width=f[12]||f[17]),b[0]&67584&&(y.height=f[11]||f[16]),b[0]&73728&&(y.container_height=f[13]||f[16]),b[0]&32768&&(y.value_img=f[15]),b[0]&16&&(y.source=f[4]),!n&&b[0]&16384&&(n=!0,y.brush_radius=f[14],Q(()=>n=!1)),!i&&b[0]&524288&&(i=!0,y.brush_color=f[19],Q(()=>i=!1)),e.$set(y),f[1]==="color-sketch"||f[1]==="sketch"?a?(a.p(f,b),b[0]&2&&p(a,1)):(a=ht(f),a.c(),p(a,1),a.m(o.parentNode,o)):a&&(G(),A(a,1,1,()=>{a=null}),K())},i(f){u||(p(e.$$.fragment,f),p(s.$$.fragment,f),p(a),u=!0)},o(f){A(e.$$.fragment,f),A(s.$$.fragment,f),A(a),u=!1},d(f){t[29](null),T(e,f),f&&I(r),T(s,f),f&&I(l),a&&a.d(f),f&&I(o)}}}function ht(t){let e,n,i,r;function s(u){t[33](u)}function l(u){t[34](u)}let o={container_height:t[13]||t[16],img_width:t[12]||t[17],img_height:t[11]||t[16],mode:t[9]};return t[14]!==void 0&&(o.brush_radius=t[14]),t[19]!==void 0&&(o.brush_color=t[19]),e=new Ve({props:o}),R.push(()=>Y(e,"brush_radius",s)),R.push(()=>Y(e,"brush_color",l)),{c(){z(e.$$.fragment)},m(u,h){M(e,u,h),r=!0},p(u,h){const _={};h[0]&73728&&(_.container_height=u[13]||u[16]),h[0]&135168&&(_.img_width=u[12]||u[17]),h[0]&67584&&(_.img_height=u[11]||u[16]),h[0]&512&&(_.mode=u[9]),!n&&h[0]&16384&&(n=!0,_.brush_radius=u[14],Q(()=>n=!1)),!i&&h[0]&524288&&(i=!0,_.brush_color=u[19],Q(()=>i=!1)),e.$set(_)},i(u){r||(p(e.$$.fragment,u),r=!0)},o(u){A(e.$$.fragment,u),r=!1},d(u){T(e,u)}}}function dn(t){let e,n,i,r;const s=[gn,mn,hn,cn,_n],l=[];function o(u,h){return u[0]===null&&!u[18]||u[5]?0:u[1]==="select"?1:u[1]==="editor"?2:(u[1]==="sketch"||u[1]==="color-sketch")&&(u[0]!==null||u[18])?3:4}return e=o(t),n=l[e]=s[e](t),{c(){n.c(),i=ue()},m(u,h){l[e].m(u,h),v(u,i,h),r=!0},p(u,h){let _=e;e=o(u),e===_?l[e].p(u,h):(G(),A(l[_],1,1,()=>{l[_]=null}),K(),n=l[e],n?n.p(u,h):(n=l[e]=s[e](u),n.c()),p(n,1),n.m(i.parentNode,i))},i(u){r||(p(n),r=!0)},o(u){A(n),r=!1},d(u){l[e].d(u),u&&I(i)}}}function bn(t){let e,n,i,r,s,l,o;e=new bt({props:{show_label:t[3],Icon:t[4]==="canvas"?Ke:Re,label:t[2]||(t[4]==="canvas"?"Sketch":"Image")}});const u=[fn,an,on,un,sn,ln,rn],h=[];function _(g,a){return g[4]==="upload"?0:g[4]==="canvas"?1:g[0]===null&&!g[18]||g[5]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[18])?5:6}return r=_(t),s=h[r]=u[r](t),{c(){z(e.$$.fragment),n=U(),i=N("div"),s.c(),d(i,"data-testid","image"),d(i,"class","svelte-zyic3i"),He(()=>t[53].call(i)),H(i,"fixed-height",t[4]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(g,a){M(e,g,a),v(g,n,a),v(g,i,a),h[r].m(i,null),l=dt(i,t[53].bind(i)),o=!0},p(g,a){const f={};a[0]&8&&(f.show_label=g[3]),a[0]&16&&(f.Icon=g[4]==="canvas"?Ke:Re),a[0]&20&&(f.label=g[2]||(g[4]==="canvas"?"Sketch":"Image")),e.$set(f);let b=r;r=_(g),r===b?h[r].p(g,a):(G(),A(h[b],1,1,()=>{h[b]=null}),K(),s=h[r],s?s.p(g,a):(s=h[r]=u[r](g),s.c()),p(s,1),s.m(i,null)),a[0]&18&&H(i,"fixed-height",g[4]!=="webcam"||g[1]==="sketch"||g[1]==="color-sketch")},i(g){o||(p(e.$$.fragment,g),p(s),o=!0)},o(g){A(e.$$.fragment,g),A(s),o=!1},d(g){T(e,g),g&&I(n),g&&I(i),h[r].d(),l()}}}function kn(t,e,n){let i,{$$slots:r={},$$scope:s}=e,{value:l}=e,{label:o=void 0}=e,{show_label:u}=e,{source:h="upload"}=e,{tool:_="editor"}=e,{streaming:g=!1}=e,{pending:a=!1}=e,{mirror_webcam:f}=e,b;l&&(h==="upload"||h==="webcam")&&_==="sketch"&&(l={image:l,mask:null});function y({detail:c}){_==="color-sketch"?n(18,$=c):n(0,l=(h==="upload"||h==="webcam")&&_==="sketch"?{image:c,mask:null}:c),ne("upload",c)}function E({detail:c}){n(0,l=null),n(18,$=void 0),ne("clear")}async function te({detail:c},C){w==="mask"?h==="webcam"&&C?n(0,l={image:c,mask:null}):n(0,l={image:typeof l=="string"?l:l?.image||null,mask:c}):(h==="upload"||h==="webcam")&&_==="sketch"?n(0,l={image:c,mask:null}):n(0,l=c),await Se(),ne(g?"stream":"edit")}const ne=ce();let B=!1;function k(c){const C=c.composedPath()[0];n(12,ie=C.naturalWidth),n(11,q=C.naturalHeight),n(13,re=C.getBoundingClientRect().height)}async function J(){b.clear(),await Se(),n(0,l=null),n(18,$=void 0)}let q=0,ie=0,re=0,D=20,w,L,le,oe,$;const de=c=>(E(c),n(1,_="editor")),Le=()=>n(1,_="select");function he(c){R[c?"unshift":"push"](()=>{L=c,n(15,L)})}function je(c){R[c?"unshift":"push"](()=>{b=c,n(10,b)})}function be(c){D=c,n(14,D)}function Ne(c){i=c,n(19,i),n(9,w),n(4,h),n(1,_)}const ke=()=>b.undo();function pe(c){D=c,n(14,D)}function we(c){i=c,n(19,i),n(9,w),n(4,h),n(1,_)}function Ae(c){B=c,n(8,B)}const ae=()=>b.undo();function ve(c){D=c,n(14,D)}function Ie(c){i=c,n(19,i),n(9,w),n(4,h),n(1,_)}function ye(c){D=c,n(14,D)}function Ce(c){i=c,n(19,i),n(9,w),n(4,h),n(1,_)}function ze(c){R[c?"unshift":"push"](()=>{b=c,n(10,b)})}const Me=c=>_==="color-sketch"?y(c):te(c,!0);function se(c){_e.call(this,t,c)}const fe=c=>(E(c),n(1,_="editor")),Te=()=>n(1,_="select");function me(c){R[c?"unshift":"push"](()=>{L=c,n(15,L)})}function Fe(c){R[c?"unshift":"push"](()=>{b=c,n(10,b)})}function Be(c){D=c,n(14,D)}function qe(c){i=c,n(19,i),n(9,w),n(4,h),n(1,_)}const Oe=()=>b.undo();function We(c){D=c,n(14,D)}function Pe(c){i=c,n(19,i),n(9,w),n(4,h),n(1,_)}function m(){le=this.offsetHeight,oe=this.offsetWidth,n(16,le),n(17,oe)}return t.$$set=c=>{"value"in c&&n(0,l=c.value),"label"in c&&n(2,o=c.label),"show_label"in c&&n(3,u=c.show_label),"source"in c&&n(4,h=c.source),"tool"in c&&n(1,_=c.tool),"streaming"in c&&n(5,g=c.streaming),"pending"in c&&n(6,a=c.pending),"mirror_webcam"in c&&n(7,f=c.mirror_webcam),"$$scope"in c&&n(54,s=c.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&ne("change",l),t.$$.dirty[0]&256&&ne("drag",B),t.$$.dirty[0]&18&&(h==="canvas"&&_==="sketch"?n(9,w="bw-sketch"):_==="color-sketch"?n(9,w="color-sketch"):(h==="upload"||h==="webcam")&&_==="sketch"?n(9,w="mask"):n(9,w="editor")),t.$$.dirty[0]&512&&n(19,i=w=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(l===null||l.image===null&&l.mask===null)&&n(18,$=void 0)},[l,_,o,u,h,g,a,f,B,w,b,q,ie,re,D,L,le,oe,$,i,y,E,te,k,J,r,de,Le,he,je,be,Ne,ke,pe,we,Ae,ae,ve,Ie,ye,Ce,ze,Me,se,fe,Te,me,Fe,Be,qe,Oe,We,Pe,m,s]}class pn extends x{constructor(e){super(),ee(this,e,kn,bn,X,{value:0,label:2,show_label:3,source:4,tool:1,streaming:5,pending:6,mirror_webcam:7},null,[-1,-1])}}function wn(t){let e,n;return{c(){e=N("img"),O(e.src,n=t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-1ku16gh")},m(i,r){v(i,e,r)},p(i,r){r&1&&!O(e.src,n=i[0])&&d(e,"src",n)},i:j,o:j,d(i){i&&I(e)}}}function An(t){let e,n;return e=new qt({props:{size:"large",unpadded_box:!0,$$slots:{default:[vn]},$$scope:{ctx:t}}}),{c(){z(e.$$.fragment)},m(i,r){M(e,i,r),n=!0},p(i,r){const s={};r&16&&(s.$$scope={dirty:r,ctx:i}),e.$set(s)},i(i){n||(p(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function vn(t){let e,n;return e=new Re({}),{c(){z(e.$$.fragment)},m(i,r){M(e,i,r),n=!0},i(i){n||(p(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function In(t){let e,n,i,r,s,l;e=new bt({props:{show_label:t[2],Icon:Re,label:t[1]||"Image"}});const o=[An,wn],u=[];function h(_,g){return _[0]===null?0:1}return i=h(t),r=u[i]=o[i](t),{c(){z(e.$$.fragment),n=U(),r.c(),s=ue()},m(_,g){M(e,_,g),v(_,n,g),u[i].m(_,g),v(_,s,g),l=!0},p(_,[g]){const a={};g&4&&(a.show_label=_[2]),g&2&&(a.label=_[1]||"Image"),e.$set(a);let f=i;i=h(_),i===f?u[i].p(_,g):(G(),A(u[f],1,1,()=>{u[f]=null}),K(),r=u[i],r?r.p(_,g):(r=u[i]=o[i](_),r.c()),p(r,1),r.m(s.parentNode,s))},i(_){l||(p(e.$$.fragment,_),p(r),l=!0)},o(_){A(e.$$.fragment,_),A(r),l=!1},d(_){T(e,_),_&&I(n),u[i].d(_),_&&I(s)}}}function yn(t,e,n){let{value:i}=e,{label:r=void 0}=e,{show_label:s}=e;const l=ce();return t.$$set=o=>{"value"in o&&n(0,i=o.value),"label"in o&&n(1,r=o.label),"show_label"in o&&n(2,s=o.show_label)},t.$$.update=()=>{t.$$.dirty&1&&i&&l("change",i)},[i,r,s]}class Cn extends x{constructor(e){super(),ee(this,e,yn,In,X,{value:0,label:1,show_label:2})}}function zn(t){let e,n,i;function r(l){t[14](l)}let s={source:t[4],tool:t[5],label:t[6],show_label:t[7],pending:t[9],streaming:t[8],mirror_webcam:t[11],$$slots:{default:[Tn]},$$scope:{ctx:t}};return t[0]!==void 0&&(s.value=t[0]),e=new pn({props:s}),R.push(()=>Y(e,"value",r)),e.$on("edit",t[15]),e.$on("clear",t[16]),e.$on("change",t[17]),e.$on("stream",t[18]),e.$on("drag",t[19]),e.$on("upload",t[20]),e.$on("error",t[21]),{c(){z(e.$$.fragment)},m(l,o){M(e,l,o),i=!0},p(l,o){const u={};o&16&&(u.source=l[4]),o&32&&(u.tool=l[5]),o&64&&(u.label=l[6]),o&128&&(u.show_label=l[7]),o&512&&(u.pending=l[9]),o&256&&(u.streaming=l[8]),o&2048&&(u.mirror_webcam=l[11]),o&8388608&&(u.$$scope={dirty:o,ctx:l}),!n&&o&1&&(n=!0,u.value=l[0],Q(()=>n=!1)),e.$set(u)},i(l){i||(p(e.$$.fragment,l),i=!0)},o(l){A(e.$$.fragment,l),i=!1},d(l){T(e,l)}}}function Mn(t){let e,n;return e=new Cn({props:{value:t[0],label:t[6],show_label:t[7]}}),{c(){z(e.$$.fragment)},m(i,r){M(e,i,r),n=!0},p(i,r){const s={};r&1&&(s.value=i[0]),r&64&&(s.label=i[6]),r&128&&(s.show_label=i[7]),e.$set(s)},i(i){n||(p(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function Tn(t){let e,n;return e=new Ot({props:{type:"image"}}),{c(){z(e.$$.fragment)},m(i,r){M(e,i,r),n=!0},p:j,i(i){n||(p(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function Bn(t){let e,n,i,r,s,l;const o=[t[1]];let u={};for(let a=0;a<o.length;a+=1)u=Bt(u,o[a]);e=new St({props:u});const h=[Mn,zn],_=[];function g(a,f){return a[12]==="static"?0:1}return i=g(t),r=_[i]=h[i](t),{c(){z(e.$$.fragment),n=U(),r.c(),s=ue()},m(a,f){M(e,a,f),v(a,n,f),_[i].m(a,f),v(a,s,f),l=!0},p(a,f){const b=f&2?Et(o,[Rt(a[1])]):{};e.$set(b);let y=i;i=g(a),i===y?_[i].p(a,f):(G(),A(_[y],1,1,()=>{_[y]=null}),K(),r=_[i],r?r.p(a,f):(r=_[i]=h[i](a),r.c()),p(r,1),r.m(s.parentNode,s))},i(a){l||(p(e.$$.fragment,a),p(r),l=!0)},o(a){A(e.$$.fragment,a),A(r),l=!1},d(a){T(e,a),a&&I(n),_[i].d(a),a&&I(s)}}}function Sn(t){let e,n;return e=new Tt({props:{visible:t[3],variant:t[12]==="dynamic"&&t[0]===null&&t[4]==="upload"?"dashed":"solid",color:t[13]?"green":"grey",padding:!1,elem_id:t[2],style:{height:t[10].height,width:t[10].width},allow_overflow:!1,$$slots:{default:[Bn]},$$scope:{ctx:t}}}),{c(){z(e.$$.fragment)},m(i,r){M(e,i,r),n=!0},p(i,[r]){const s={};r&8&&(s.visible=i[3]),r&4113&&(s.variant=i[12]==="dynamic"&&i[0]===null&&i[4]==="upload"?"dashed":"solid"),r&8192&&(s.color=i[13]?"green":"grey"),r&4&&(s.elem_id=i[2]),r&1024&&(s.style={height:i[10].height,width:i[10].width}),r&8403955&&(s.$$scope={dirty:r,ctx:i}),e.$set(s)},i(i){n||(p(e.$$.fragment,i),n=!0)},o(i){A(e.$$.fragment,i),n=!1},d(i){T(e,i)}}}function En(t,e,n){let{elem_id:i=""}=e,{visible:r=!0}=e,{value:s=null}=e,{source:l="upload"}=e,{tool:o="editor"}=e,{label:u}=e,{show_label:h}=e,{streaming:_}=e,{pending:g}=e,{style:a={}}=e,{mirror_webcam:f}=e,{loading_status:b}=e,{mode:y}=e;const E=ce();let te;function ne(w){s=w,n(0,s)}function B(w){_e.call(this,t,w)}function k(w){_e.call(this,t,w)}function J(w){_e.call(this,t,w)}function q(w){_e.call(this,t,w)}const ie=({detail:w})=>n(13,te=w);function re(w){_e.call(this,t,w)}const D=({detail:w})=>{n(1,b=b||{}),n(1,b.status="error",b),n(1,b.message=w,b)};return t.$$set=w=>{"elem_id"in w&&n(2,i=w.elem_id),"visible"in w&&n(3,r=w.visible),"value"in w&&n(0,s=w.value),"source"in w&&n(4,l=w.source),"tool"in w&&n(5,o=w.tool),"label"in w&&n(6,u=w.label),"show_label"in w&&n(7,h=w.show_label),"streaming"in w&&n(8,_=w.streaming),"pending"in w&&n(9,g=w.pending),"style"in w&&n(10,a=w.style),"mirror_webcam"in w&&n(11,f=w.mirror_webcam),"loading_status"in w&&n(1,b=w.loading_status),"mode"in w&&n(12,y=w.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,s=s||null),t.$$.dirty&1&&E("change")},[s,b,i,r,l,o,u,h,_,g,a,f,y,te,ne,B,k,J,q,ie,re,D]}class Rn extends x{constructor(e){super(),ee(this,e,En,Sn,X,{elem_id:2,visible:3,value:0,source:4,tool:5,label:6,show_label:7,streaming:8,pending:9,style:10,mirror_webcam:11,loading_status:1,mode:12})}}var Pn=Rn;const Jn=["static","dynamic"],Hn=t=>({type:"string",description:"image data as base64 string",example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{Pn as Component,Vn as ExampleComponent,Hn as document,Jn as modes};
//# sourceMappingURL=index.9af23f8b.js.map
